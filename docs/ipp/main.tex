%
%                       This is a basic LaTeX Template
%                       for the Informatics Research Review

\documentclass[a4paper,11pt]{article}
% Add local fullpage and head macros
\usepackage{head,fullpage}     
% Add graphicx package with pdf flag (must use pdflatex)
\usepackage[pdftex]{graphicx}  
% Better support for URLs
\usepackage{url}
% Date formating
\usepackage{datetime}
% For Gantt chart
\usepackage{pgfgantt}
\usepackage{xcolor}
\usepackage[utf8]{inputenc}

\usepackage{natbib}
\usepackage{svg} 
\usepackage{xstring}
\usepackage{catchfile}

\usepackage{longtable}
\usepackage{booktabs}
% \usepackage{adjustbox}

% \usepackage{tabularx}
% \usepackage{minipage-marginpar}
% \usepackage{real}

\usepackage{mdframed}

\definecolor{shadecolor}{gray}{0.97} % Define the shade color using the xcolor package

\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
\newenvironment{Shaded}{\begin{mdframed}[backgroundcolor=shadecolor,hidealllines=true]}{\end{mdframed}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}

\def\tightlist{\itemsep1pt \parskip0pt \parsep0pt}

\renewcommand{\includesvg}[2][]{
    \StrBefore{#2}{.}[\filepath]
    \StrBetween{#2}{/}{.}[\filename]
    
    % \immediate\write18{pwsh -Command "Start-Sleep -Seconds 1"}
    \immediate\write18{pwsh -Command "cat #2 | python ../adjust_viewbox.py 0 40 0 -40 > \filepath_adjusted.svg"}
    % \immediate\write18{pwsh -Command "mv \filepath.tmp #2 -Force"}
    \immediate\write18{xml sel -t -v "(//text())[last()]" #2 > \filepath.txt}
    \immediate\write18{svg2pdf \filepath_adjusted.svg \filepath.pdf}

    \begin{figure}[!ht]
        \centering
        % \adjustbox{cfbox=black 1pt}{\includegraphics[width=\textwidth]{\filepath.pdf}}
        \includegraphics[width=\textwidth]{\filepath.pdf}

        \newcommand{\filecontent}{}
        \CatchFileDef{\filecontent}{\filepath.txt}{}
        
        \caption{\filecontent}

        % \caption{\verbatiminput{\filepath.txt}}
        \label{fig:\filename}
    \end{figure}
    % \noindent\includegraphics[width=\textwidth]{\filename.pdf}
}

\newdateformat{monthyeardate}{%
  \monthname[\THEMONTH] \THEYEAR}

\parindent=0pt          %  Switch off indent of paragraphs 
\parskip=5pt            %  Put 5pt between each paragraph  
\Urlmuskip=0mu plus 1mu %  Better line breaks for URLs


%                       This section generates a title page
%                       Edit only the following three lines
%                       providing your exam number, 
%                       the general field of study you are considering
%                       for your review, and name of IRR tutor

\newcommand{\examnumber}{Nathan Daniel Walsh 5}
\newcommand{\field}{eel (easy extract load): Human-Readable Declarative Extract-Load Configuration Language \& System}
\newcommand{\tutor}{Brian Mitchell}
\newcommand{\supervisor}{Milos Nikolic}

\begin{document}
\thispagestyle{empty}
\begin{minipage}[b]{110mm}
    {\Huge\bf School of Informatics
        \vspace*{17mm}}
\end{minipage}
\hfill
\begin{minipage}[t]{40mm}
    \makebox[40mm]{
        \includegraphics[width=40mm]{crest.png}}
\end{minipage}
\par\noindent
% Centre Title, and name
\vspace*{2cm}
\begin{center}
    \Large\bf Informatics Project Proposal \\
    \Large\bf \field
\end{center}
\vspace*{1.5cm}
\begin{center}
    \bf \examnumber\\
    \monthyeardate\today
\end{center}
\vspace*{5mm}

%
%                       Insert your abstract HERE
%                       
\begin{abstract}
    \input{abstract.tex}
\end{abstract}

\vspace*{1cm}

\vspace*{3cm}
Date: \today

\vfill
{\bf Tutor:} \tutor\\
{\bf Supervisor:} \supervisor
\newpage

%                                               Through page and setup 
%                                               fancy headings
\setcounter{page}{1}                            % Set page number to 1
\footruleheight{1pt}
\headruleheight{1pt}
\lfoot{\small School of Informatics}
\lhead{Informatics Research Review}
\rhead{- \thepage}
\cfoot{}
\rfoot{Date: \date{\today}}
%

\listoffigures
\listoftables
\pagebreak

\tableofcontents
\pagebreak

\input{body.tex}
\pagebreak
%                Now build the reference list
\bibliographystyle{unsrt}   % The reference style
%                This is plain and unsorted, so in the order
%                they appear in the document.

{\small
    \bibliography{main}       % bib file(s).
}
\end{document}

