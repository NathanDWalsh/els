%
%                       This is a basic LaTeX Template
%                       for the Informatics Research Review

\documentclass[a4paper,11pt]{article}
% Add local fullpage and head macros
\usepackage{head,fullpage}     
% Add graphicx package with pdf flag (must use pdflatex)
\usepackage[pdftex]{graphicx}  
% Better support for URLs
\usepackage{url}
% Date formating
\usepackage{datetime}
% For Gantt chart
\usepackage{pgfgantt}
\usepackage{xcolor}
\usepackage[utf8]{inputenc}

\usepackage{natbib}
\usepackage{svg} 
\usepackage{xstring}
\usepackage{catchfile}

\usepackage{longtable}
\usepackage{booktabs}
% \usepackage{adjustbox}

\def\tightlist{\itemsep1pt \parskip0pt \parsep0pt}

\renewcommand{\includesvg}[2][]{
    \StrBefore{#2}{.}[\filepath]
    \StrBetween{#2}{/}{.}[\filename]
    
    % \immediate\write18{pwsh -Command "Start-Sleep -Seconds 1"}
    \immediate\write18{pwsh -Command "cat #2 | python ../adjust_viewbox.py 0 40 0 -40 > \filepath_adjusted.svg"}
    % \immediate\write18{pwsh -Command "mv \filepath.tmp #2 -Force"}
    \immediate\write18{xml sel -t -v "(//text())[last()]" #2 > \filepath.txt}
    \immediate\write18{svg2pdf \filepath_adjusted.svg \filepath.pdf}

    \begin{figure}[!ht]
        \centering
        % \adjustbox{cfbox=black 1pt}{\includegraphics[width=\textwidth]{\filepath.pdf}}
        \includegraphics[width=\textwidth]{\filepath.pdf}

        \newcommand{\filecontent}{}
        \CatchFileDef{\filecontent}{\filepath.txt}{}
        
        \caption{\filecontent}

        % \caption{\verbatiminput{\filepath.txt}}
        \label{fig:\filename}
    \end{figure}
    % \noindent\includegraphics[width=\textwidth]{\filename.pdf}
}

\newdateformat{monthyeardate}{%
  \monthname[\THEMONTH] \THEYEAR}

\parindent=0pt          %  Switch off indent of paragraphs 
\parskip=5pt            %  Put 5pt between each paragraph  
\Urlmuskip=0mu plus 1mu %  Better line breaks for URLs


%                       This section generates a title page
%                       Edit only the following three lines
%                       providing your exam number, 
%                       the general field of study you are considering
%                       for your review, and name of IRR tutor

\newcommand{\examnumber}{B188411}
\newcommand{\field}{eel (easy extract load): Human-Readable Declarative Extract-Load Configuration Language \& System}
\newcommand{\tutor}{Brian Mitchell}
\newcommand{\supervisor}{Milos Nikolic}

\begin{document}
\begin{minipage}[b]{110mm}
    {\Huge\bf School of Informatics 41
        \vspace*{17mm}}
\end{minipage}
\hfill
\begin{minipage}[t]{40mm}
    \makebox[40mm]{
        \includegraphics[width=40mm]{crest.png}}
\end{minipage}
\par\noindent
% Centre Title, and name
\vspace*{2cm}
\begin{center}
    \Large\bf Informatics Project Proposal \\
    \Large\bf \field
\end{center}
\vspace*{1.5cm}
\begin{center}
    \bf \examnumber\\
    \monthyeardate\today
\end{center}
\vspace*{5mm}

%
%                       Insert your abstract HERE
%                       
\begin{abstract}
    \input{abstract.tex}
\end{abstract}

\vspace*{1cm}

\vspace*{3cm}
Date: \today

\vfill
{\bf Tutor:} \tutor\\
{\bf Supervisor:} \supervisor
\newpage

%                                               Through page and setup 
%                                               fancy headings
\setcounter{page}{1}                            % Set page number to 1
\footruleheight{1pt}
\headruleheight{1pt}
\lfoot{\small School of Informatics}
\lhead{Informatics Research Review}
\rhead{- \thepage}
\cfoot{}
\rfoot{Date: \date{\today}}
%

\tableofcontents
\pagebreak

\input{body.tex}

%                Now build the reference list
\bibliographystyle{unsrt}   % The reference style
%                This is plain and unsorted, so in the order
%                they appear in the document.

{\small
    \bibliography{main}       % bib file(s).
}
\end{document}

